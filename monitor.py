import os

def thread_worker(url):
	try:
		import requests
		response = requests.get(url)
		if response.status_code != 200:
			print ("Response Code Failure: {} for url {}".format(response.status_code, url))
	except:
		response = None
		print ("Site not Reachable")
	return response

def process_worker(urls):
	response = []
	import concurrent.futures
	executor = concurrent.futures.ThreadPoolExecutor(max_workers=len(urls))
	future_to_url = {executor.submit(thread_worker, url): url for url in urls}
	for future in concurrent.futures.as_completed(future_to_url):
		url = future_to_url[future]
		try:
			data = future.result()
		except Exception as exc:
			print('%r generated an exception: %s' % (url, exc))
		response.append(data)

	print ('work done by process ', os.getpid())
	return response

def process_init():
	if hasattr(os, 'getppid'):
		print ('parent process:', os.getppid())
	print ('process id:', os.getpid())

def main():
	from multiprocessing import cpu_count, Pool
	cpu_count = cpu_count() * 2
	process_pool = Pool(initializer=process_init, processes=cpu_count)
	# get the urls list from database
	urls = [
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		],
		[
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com',
			'https://www.google.com', 
			'https://www.facebook.com',
			'https://www.zoho.com',
			'https://www.fidelity.com',
			'https://www.freshworks.com'
		]
	]

	result = process_pool.map(process_worker, urls)
	process_pool.close()
	process_pool.join()
	print (result)
	# update the database

if __name__=="__main__":
	import time
	starting_time = time.time()
	print ('starting time {}'.format(starting_time))
	main()
	ending_time = time.time()
	print ('ending time {}'.format(ending_time))
	print ('total time taken {}'.format(ending_time - starting_time))
